purge
Cla=[
    4.4011
    4.4012
    4.4013
    4.4014
    4.4015
    4.4016
    4.4017
    4.4018
    4.4019
    4.4020
    4.4021
    4.4022
    4.4023
    4.4024
    4.4025
    4.4026
    4.4027
    4.4028
    4.4029
    4.4030
    4.4031
    4.4032
    4.4033
    4.4034
    4.4035
    4.4036
    4.4037
    4.4038
    4.4040
    4.4041
    4.4042
    4.4043
    4.4044
    4.4045
    4.4046
    4.4048
    4.4049
    4.4050
    4.4051
    4.4052
    4.4054
    4.4055
    4.4056
    4.4057
    4.4059
    4.4060
    4.4061
    4.4062
    4.4064
    4.4065
    4.4066
    4.4068
    4.4069
    4.4070
    4.4072
    4.4073
    4.4074
    4.4076
    4.4077
    4.4079
    4.4080
    4.4081
    4.4083
    4.4084
    4.4086
    4.4087
    4.4089
    4.4090
    4.4092
    4.4093
    4.4095
    4.4096
    4.4098
    4.4100
    4.4101
    4.4103
    4.4104
    4.4106
    4.4108
    4.4109
    4.4111
    4.4113
    4.4115
    4.4116
    4.4118
    4.4120
    4.4122
    4.4123
    4.4125
    4.4127
    4.4129
    4.4131
    4.4132
    4.4134
    4.4136
    4.4138
    4.4140
    4.4142
    4.4144
    4.4146
    4.4148
    4.4150
    4.4152
    4.4154
    4.4156
    4.4158
    4.4160
    4.4163
    4.4165
    4.4167
    4.4169
    4.4171
    4.4174
    4.4176
    4.4178
    4.4181
    4.4183
    4.4185
    4.4188
    4.4190
    4.4192
    4.4195
    4.4197
    4.4200
    4.4202
    4.4205
    4.4208
    4.4210
    4.4213
    4.4215
    4.4218
    4.4221
    4.4224
    4.4226
    4.4229
    4.4232
    4.4235
    4.4238
    4.4241
    4.4244
    4.4247
    4.4250
    4.4253
    4.4256
    4.4259
    4.4262
    4.4265
    4.4268
    4.4272
    4.4275
    4.4278
    4.4282
    4.4285
    4.4289
    4.4292
    4.4296
    4.4299
    4.4303
    4.4307
    4.4310
    4.4314
    4.4318
    4.4322
    4.4326
    4.4329
    4.4333
    4.4337
    4.4342
    4.4346
    4.4350
    4.4354
    4.4358
    4.4363
    4.4367
    4.4372
    4.4376
    4.4381
    4.4385
    4.4390
    4.4395
    4.4400
    4.4405
    4.4410
    4.4415
    4.4420
    4.4425
    4.4430
    4.4435
    4.4441
    4.4446
    4.4452
    4.4457
    4.4463
    4.4469
    4.4475
    4.4481
    4.4487
    4.4493
    4.4499
    4.4505
    4.4512
    4.4518
    4.4525
    4.4532
    4.4539
    4.4546
    4.4553
    4.4560
    4.4567
    4.4575
    4.4582
    4.4590
    4.4598
    4.4605
    4.4613
    4.4622
    4.4630
    4.4639
    4.4647
    4.4656
    4.4665
    4.4674
    4.4683
    4.4693
    4.4702
    4.4712
    4.4722
    4.4733
    4.4743
    4.4754
    4.4764
    4.4776
    4.4787
    4.4798
    4.4810
    4.4822
    4.4834
    4.4847
    4.4860
    4.4873
    4.4886
    4.4900
    4.4914
    4.4929
    4.4943
    4.4958
    4.4974
    4.4990
    4.5006
    4.5023
    4.5040
    4.5057
    4.5076
    4.5094
    4.5113
    4.5133
    4.5153
    4.5174
    4.5196
    4.5218
    4.5241
    4.5264
    4.5289
    4.5314
    4.5340
    4.5368
    4.5396
    4.5425
    4.5455
    4.5487
    4.5520
    4.5554
    4.5590
    4.5628
    4.5667
    4.5709
    4.5752
    4.5798
    4.5847
    4.5899
    4.5954
    4.6012
    4.6075
    4.6143
    4.6216
    4.6295
    4.6383
    4.6480
    4.6588
    4.6711
    4.6853
    4.7020
    4.7226
    4.7491
    4.7870
    4.8542
    5.1342];

y = [5:-0.01:2.04]';

%plot(y,Cla)

figure()

d = y-2.04;
ClaP = ((Cla./min(Cla)));
plot(d,ClaP)
% hold on
% for ii = [1:10:length(ClaP),length(ClaP)]
%   plot(d(ii),ClaP(ii),'ro')
% end

%Fit Curve to p = A*exp(-s*d);

% ln(p) = [1 -d]*[ln(A) ; s]
p = log(log(ClaP));
p(1) = [];
d(1) = [];

plot(d,p)

% X = p;
% N = 6;
% alfa = 0.85;
% H = [exp(-alfa.*d)];
% for ii = 2:N
%   H = [H exp(-alfa.*ii.*d)];
% end
% coeff = inv(H'*H)*H'*X
% pf = 0.*p;
% for ii = 1:length(coeff)
%   pf = pf + coeff(ii)*exp(-alfa.*ii.*d);
% end
% hold on
% plot(d,pf,'r-')

X = p;
N = 3;
alfa = 1;
H = [ones(length(d),1)];
for ii = 1:N
  H = [H d.^ii];
end
coeff = inv(H'*H)*H'*X
df = linspace(0,3,100);
pf = 0.*df;
for ii = 1:length(coeff)
  pf = pf + coeff(ii)*df.^(ii-1);
end
hold on
plot(df,pf,'r-')

figure
plot(d,exp(exp(p)))
hold on
b = exp(exp(pf));
b(df<0.029)=b(df<0.029).*1.07; 
%%jackpot this will work let's code
%it on monday
plot(df,b,'r-')

% coeff =

%    -2.4733
%    -3.7426
%     2.1620
%    -0.5524

% % p(1) = p(2);

% % vec = [1,250,297];

% % X = log(p(vec));
% % H = [ones(length(d(vec)),1),-d(vec)];

% % theta = inv(H'*H)*H'*X;

% % lna = theta(1);
% % s = theta(2)
% % A = exp(lna)

% % %%%p = B/d
% % %p*d = B

% % B = mean(p.*(d))

% % %%p = C1 + C2/d;
% % X = p.*d;
% % H = [d ones(length(d),1)];
% % theta = inv(H'*H)*H'*X;
% % C1 = theta(1)
% % C2 = theta(2)

% % %p2 = A.*exp(-s.*d);
% % %p3 = B./(d);
% % %p4 = A*exp(-s.*d);

% % %%%Fourier Series
% % %p = sum(an*cos(n*d))
% % d = d+0.1;
% % pf = 0.*p;
% % N = 100;
% % dx = d(1)./length(d);
% % plot(d,p)
% % pfmat = zeros(length(d),N);
% % for ii = 1:N
% %   %%Compute an
% %   an = 0;
% %   for jj = 1:length(d)
% %     an = an + p(jj).*dx.*cos(ii*d(jj));
% %   end
% %   hold on
% %   pf = pf + an.*cos(ii.*d);
% %   plot(d,pf,'k-')  
% %   pfmat(:,ii) = pf;
% % end

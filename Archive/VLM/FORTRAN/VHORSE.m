function [U,A,W] = VHORSE(XPT,YPT,ZPT,X1N,Y1N,Z1N,X2N,Y2N,Z2N)
% C     
% C     COMPUTE DOWNWASH AT A POINT XPT, YPT, ZPT DUE TO A
% C     UNIT STRENGTH HORSESHOE VORTEX AT X1N,Y1N,Z1N - X2N,Y2N,Z2N
% C     
%      COMMON /CONST/PI,COEFH
% C     
% C     THE BOUND VORTEX
% C     
D1 = sqrt((XPT -X1N)^2+(YPT-Y1N)^2+(ZPT-Z1N)^2);
D2 = sqrt((XPT -X2N)^2+(YPT-Y2N)^2+(ZPT-Z2N)^2);
T21= ((X2N-X1N)*(XPT-X1N)+(Y2N-Y1N)*(YPT-Y1N)+(Z2N-Z1N)*(ZPT-Z1N))/D1;
T22= ((X2N-X1N)*(XPT-X2N)+(Y2N-Y1N)*(YPT-Y2N)+(Z2N-Z1N)*(ZPT-Z2N))/D2;
T2 = T21 - T22;
T1I = (YPT-Y1N)*(ZPT-Z2N)-(ZPT-Z1N)*(YPT-Y2N);
T1J = (XPT-X1N)*(ZPT-Z2N)-(ZPT-Z1N)*(XPT-X2N);
T1K = (XPT-X1N)*(YPT-Y2N)-(YPT-Y1N)*(XPT-X2N);
T1D = T1I^2 + T1J^2 + T1K^2;
T1X = 0.0;
T1Y = 0.0;
T1Z = 0.0;
if (T1D <= 0.00001) 
  % WRITE (10,100) T1D,T1I,T1J,T1K,XPT,X1N,X2N,YPT,Y1N,Y2N
  % 100  FORMAT(//5X,4E16.6/5X,3E16.6/5X,3E16.6//)
else
  T1X = T1I/T1D;
  T1Y =-T1J/T1D;
  T1Z = T1K/T1D;
end

UBND = T2*T1X;
VBND = T2*T1Y;
WBND = T2*T1Z;
% C     
% C     THE A TO INFINITY VORTEX
% C     
CA1 = (ZPT - Z1N)^2 + (YPT - Y1N)^2;
CA2 = sqrt(CA1 + (XPT - X1N)^2);
COEFA = (1.0 + (XPT - X1N)/CA2)/CA1;
UAI = 0.0;
VAI = (ZPT - Z1N)*COEFA;
WAI = (Y1N - YPT)*COEFA;
% C     
% C     THE B TO INFINITY VORTEX
% C     
CB1 = (ZPT - Z2N)^2 + (YPT - Y2N)^2;
CB2 = sqrt(CB1 + (XPT - X2N)^2);
COEFB = (1.0 + (XPT - X2N)/CB2)/CB1;

UBI = 0.0;
VBI = -(ZPT - Z2N)*COEFB;
WBI = -(Y2N - YPT)*COEFB;

COEFH = 1.0/(4.0*pi);

U = COEFH*(UBND + UAI + UBI);
A = COEFH*(VBND + VAI + VBI);
W = COEFH*(WBND + WAI + WBI);
